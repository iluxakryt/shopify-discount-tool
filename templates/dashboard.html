<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopify Discount Manager</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <style>
        body {
            background-color: #0d1117;
            color: #f0f6fc;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
        }

        .sidebar {
            background-color: #161b22;
            border-right: 1px solid #30363d;
            min-height: 100vh;
        }

        .nav-link {
            color: #8b949e !important;
            padding: 12px 20px;
            border-radius: 8px;
            margin: 4px 16px;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .nav-link:hover {
            background-color: #21262d;
            color: #58a6ff !important;
        }

        .nav-link.active {
            background-color: #1f6feb;
            color: #ffffff !important;
        }

        .card {
            background-color: #161b22;
            border: 1px solid #30363d;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(1, 4, 9, 0.8);
        }

        .card-header {
            background-color: #21262d;
            border-bottom: 1px solid #30363d;
            color: #f0f6fc;
            font-weight: 600;
            padding: 20px;
        }

        .card-body {
            padding: 24px;
        }

        .form-control,
        .form-select {
            background-color: #0d1117;
            border: 2px solid #30363d;
            color: #f0f6fc;
            border-radius: 8px;
            padding: 12px 16px;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .form-control:focus,
        .form-select:focus {
            background-color: #0d1117;
            border-color: #1f6feb;
            color: #f0f6fc;
            box-shadow: 0 0 0 3px rgba(31, 111, 235, 0.3);
        }

        .form-control::placeholder {
            color: #6e7681;
        }

        .form-label {
            color: #f0f6fc;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-text {
            color: #8b949e;
            font-size: 12px;
            margin-top: 6px;
        }

        .btn {
            border-radius: 8px;
            font-weight: 600;
            padding: 12px 24px;
            transition: all 0.2s ease;
        }

        .btn-primary {
            background-color: #238636;
            border-color: #238636;
            color: #ffffff;
        }

        .btn-primary:hover {
            background-color: #2ea043;
            border-color: #2ea043;
            transform: translateY(-1px);
        }

        .btn-outline-primary {
            color: #58a6ff;
            border-color: #58a6ff;
            background-color: transparent;
        }

        .btn-outline-primary:hover {
            background-color: #58a6ff;
            border-color: #58a6ff;
            color: #ffffff;
        }

        .strategy-card {
            background-color: #21262d;
            border: 2px solid #30363d;
            border-radius: 12px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            height: 100%;
            margin-bottom: 16px;
        }

        .strategy-card:hover {
            border-color: #58a6ff;
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(88, 166, 255, 0.2);
        }

        .strategy-card.selected {
            border-color: #1f6feb;
            background-color: #0969da;
            color: #ffffff;
        }

        .strategy-card.selected .text-muted {
            color: #b6e3ff !important;
        }

        .strategy-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.8;
        }

        .strategy-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .strategy-description {
            font-size: 14px;
            opacity: 0.8;
            line-height: 1.4;
        }

        .preview-section {
            background-color: #0d1117;
            border: 2px dashed #30363d;
            border-radius: 12px;
            padding: 24px;
            margin-top: 20px;
        }

        .preview-title {
            color: #58a6ff;
            font-weight: 700;
            font-size: 18px;
            margin-bottom: 16px;
        }

        .price-before,
        .price-after {
            background-color: #21262d;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 16px;
            text-align: center;
        }

        .price-old {
            text-decoration: line-through;
            color: #8b949e;
            font-size: 18px;
        }

        .price-new {
            color: #238636;
            font-size: 24px;
            font-weight: 700;
        }

        .discount-badge {
            background-color: #1f6feb;
            color: #ffffff;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
            margin-top: 8px;
            display: inline-block;
        }

        .progress {
            background-color: #21262d;
            border: 1px solid #30363d;
            border-radius: 8px;
            height: 24px;
        }

        .progress-bar {
            background-color: #238636;
            border-radius: 8px;
            font-weight: 600;
        }

        .stat-box {
            background-color: #21262d;
            border: 1px solid #30363d;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            margin-bottom: 16px;
        }

        .stat-icon {
            font-size: 32px;
            margin-bottom: 12px;
        }

        .stat-number {
            font-size: 24px;
            font-weight: 700;
            color: #f0f6fc;
        }

        .stat-label {
            font-size: 12px;
            color: #8b949e;
            text-transform: uppercase;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .alert {
            border-radius: 8px;
            border: 1px solid;
            padding: 16px;
            margin: 16px 0;
        }

        .alert-success {
            background-color: rgba(35, 134, 54, 0.15);
            border-color: #238636;
            color: #7ee787;
        }

        .alert-danger {
            background-color: rgba(248, 81, 73, 0.15);
            border-color: #f85149;
            color: #ffa198;
        }

        .alert-info {
            background-color: rgba(88, 166, 255, 0.15);
            border-color: #58a6ff;
            color: #79c0ff;
        }

        .help-section {
            background-color: #161b22;
            border: 1px solid #30363d;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
        }

        .help-title {
            color: #58a6ff;
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .help-content h6 {
            color: #f0f6fc;
            font-weight: 600;
            margin-top: 24px;
            margin-bottom: 12px;
            font-size: 16px;
        }

        .help-content ul {
            margin-left: 20px;
            margin-bottom: 16px;
        }

        .help-content li {
            color: #e6edf3;
            margin-bottom: 8px;
            line-height: 1.6;
        }

        .help-content strong {
            color: #58a6ff;
            font-weight: 600;
        }

        .example-box {
            background-color: #0d1117;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }

        h1, h2, h3, h4, h5, h6 {
            color: #f0f6fc;
        }

        .text-muted {
            color: #8b949e !important;
        }

        .sidebar-brand {
            padding: 24px 20px;
            border-bottom: 1px solid #30363d;
            text-align: center;
        }

        .brand-title {
            color: #58a6ff;
            font-size: 20px;
            font-weight: 800;
            margin: 0;
        }

        .brand-subtitle {
            color: #8b949e;
            font-size: 12px;
            margin-top: 4px;
        }

        .current-item {
            background-color: #21262d;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 12px 16px;
            margin-top: 16px;
            text-align: center;
            font-size: 14px;
            color: #8b949e;
        }

        .spinner-border-sm {
            width: 16px;
            height: 16px;
        }
    </style>
</head>
<body>
    <div class="container-fluid" x-data="discountApp()">
        <div class="row">
            <!-- Sidebar -->
            <nav class="col-md-3 col-lg-2 d-md-block sidebar">
                <div class="sidebar-brand">
                    <h4 class="brand-title">
                        <i class="fas fa-percentage me-2"></i>
                        Shopify
                    </h4>
                    <div class="brand-subtitle">Discount Manager</div>
                </div>
                
                <div class="py-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" 
                               :class="{ 'active': currentTab === 'main' }"
                               href="#" 
                               @click="currentTab = 'main'">
                                <i class="fas fa-home me-2"></i>
                                –ì–æ–ª–æ–≤–Ω–∞
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link"
                               :class="{ 'active': currentTab === 'help' }"
                               href="#" 
                               @click="currentTab = 'help'">
                                <i class="fas fa-book me-2"></i>
                                –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- Main Content -->
            <main class="col-md-9 col-lg-10 ms-sm-auto px-md-4">
                
                <!-- Main Tab -->
                <div x-show="currentTab === 'main'">
                    <div class="py-4">
                        <h1 class="mb-4">
                            <i class="fas fa-tags me-3"></i>
                            –ö–µ—Ä—É–≤–∞–Ω–Ω—è –∑–Ω–∏–∂–∫–∞–º–∏ —Ç–æ–≤–∞—Ä—ñ–≤
                        </h1>
                        
                        <!-- Strategy Selection -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-chess me-2"></i>
                                    –ö—Ä–æ–∫ 1: –û–±–µ—Ä—ñ—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥—ñ—é –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="row g-3">
                                    <div class="col-md-6 col-xl-3">
                                        <div class="strategy-card" 
                                             :class="{ 'selected': form.strategy === 'increase_compare_only' }"
                                             @click="selectStrategy('increase_compare_only')">
                                            <div class="strategy-icon text-success">
                                                <i class="fas fa-arrow-up"></i>
                                            </div>
                                            <div class="strategy-title">–ó–±—ñ–ª—å—à–∏—Ç–∏ –∑–Ω–∏–∂–∫—É</div>
                                            <div class="strategy-description text-muted">
                                                –ü—ñ–¥–≤–∏—â–∏—Ç–∏ –ø–æ—Ä—ñ–≤–Ω—è–ª—å–Ω—É —Ü—ñ–Ω—É, –∑–∞–ª–∏—à–∏–≤—à–∏ —Ä–µ–∞–ª—å–Ω—É –±–µ–∑ –∑–º—ñ–Ω
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-xl-3">
                                        <div class="strategy-card"
                                             :class="{ 'selected': form.strategy === 'decrease_price_only' }"
                                             @click="selectStrategy('decrease_price_only')">
                                            <div class="strategy-icon text-info">
                                                <i class="fas fa-arrow-down"></i>
                                            </div>
                                            <div class="strategy-title">–ó–º–µ–Ω—à–∏—Ç–∏ —Ü—ñ–Ω—É</div>
                                            <div class="strategy-description text-muted">
                                                –ó–Ω–∏–∑–∏—Ç–∏ —Ä–µ–∞–ª—å–Ω—É —Ü—ñ–Ω—É —Ç–æ–≤–∞—Ä—É –¥–ª—è –ø–æ–∫—É–ø—Ü—ñ–≤
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-xl-3">
                                        <div class="strategy-card"
                                             :class="{ 'selected': form.strategy === 'both_directions' }"
                                             @click="selectStrategy('both_directions')">
                                            <div class="strategy-icon text-warning">
                                                <i class="fas fa-exchange-alt"></i>
                                            </div>
                                            <div class="strategy-title">–û–±–∏–¥–≤—ñ —Ü—ñ–Ω–∏</div>
                                            <div class="strategy-description text-muted">
                                                –ó–º—ñ–Ω–∏—Ç–∏ —ñ —Ä–µ–∞–ª—å–Ω—É, —ñ –ø–æ—Ä—ñ–≤–Ω—è–ª—å–Ω—É —Ü—ñ–Ω—É –æ–¥–Ω–æ—á–∞—Å–Ω–æ
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-xl-3">
                                        <div class="strategy-card"
                                             :class="{ 'selected': form.strategy === 'set_discount_percentage' }"
                                             @click="selectStrategy('set_discount_percentage')">
                                            <div class="strategy-icon text-danger">
                                                <i class="fas fa-bullseye"></i>
                                            </div>
                                            <div class="strategy-title">–¢–æ—á–Ω–∞ –∑–Ω–∏–∂–∫–∞</div>
                                            <div class="strategy-description text-muted">
                                                –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –≤—ñ–¥—Å–æ—Ç–æ–∫ –∑–Ω–∏–∂–∫–∏
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Settings Form -->
                        <div class="card mb-4" x-show="form.strategy" x-transition>
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-cogs me-2"></i>
                                    –ö—Ä–æ–∫ 2: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤
                                </h5>
                            </div>
                            <div class="card-body">
                                <form @submit.prevent="submitUpdate()">
                                    <div class="row">
                                        <!-- Left Column -->
                                        <div class="col-lg-6">
                                            <div class="mb-4" x-show="form.strategy !== 'set_discount_percentage'">
                                                <label class="form-label">
                                                    <i class="fas fa-percentage me-2"></i>
                                                    –ó–Ω–∞—á–µ–Ω–Ω—è –∑–º—ñ–Ω–∏ (%)
                                                </label>
                                                <input type="number" 
                                                       class="form-control" 
                                                       x-model="form.value"
                                                       step="0.01" 
                                                       min="0" 
                                                       max="1000"
                                                       required>
                                                <div class="form-text">
                                                    <i class="fas fa-info-circle me-1"></i>
                                                    <span x-text="getHelpText()"></span>
                                                </div>
                                            </div>
                                            
                                            <div class="mb-4" x-show="form.strategy === 'set_discount_percentage'">
                                                <label class="form-label">
                                                    <i class="fas fa-bullseye me-2"></i>
                                                    –ë–∞–∂–∞–Ω–∏–π –≤—ñ–¥—Å–æ—Ç–æ–∫ –∑–Ω–∏–∂–∫–∏ (%)
                                                </label>
                                                <input type="number" 
                                                       class="form-control" 
                                                       x-model="form.target_discount"
                                                       step="0.01" 
                                                       min="0" 
                                                       max="99"
                                                       required>
                                                <div class="form-text">
                                                    <i class="fas fa-lightbulb me-1"></i>
                                                    –ù–∞–ø—Ä–∏–∫–ª–∞–¥: 25 –¥–ª—è –∑–Ω–∏–∂–∫–∏ 25%
                                                </div>
                                            </div>

                                            <div class="mb-4">
                                                <label class="form-label">
                                                    <i class="fas fa-filter me-2"></i>
                                                    –§—ñ–ª—å—Ç—Ä —Ç–æ–≤–∞—Ä—ñ–≤
                                                </label>
                                                <select class="form-select" x-model="form.filter_type">
                                                    <option value="all">üåü –í—Å—ñ —Ç–æ–≤–∞—Ä–∏ –≤ –º–∞–≥–∞–∑–∏–Ω—ñ</option>
                                                    <option value="product_type">üè∑Ô∏è –ó–∞ —Ç–∏–ø–æ–º —Ç–æ–≤–∞—Ä—É</option>
                                                    <option value="vendor">üè≠ –ó–∞ –≤–∏—Ä–æ–±–Ω–∏–∫–æ–º/–±—Ä–µ–Ω–¥–æ–º</option>
                                                </select>
                                                <div class="form-text">
                                                    <i class="fas fa-info-circle me-1"></i>
                                                    –û–±–µ—Ä—ñ—Ç—å —è–∫—ñ —Ç–æ–≤–∞—Ä–∏ –æ–±—Ä–æ–±–ª—è—Ç–∏
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Right Column -->
                                        <div class="col-lg-6">
                                            <div class="mb-4" x-show="form.filter_type !== 'all'">
                                                <label class="form-label">
                                                    <i class="fas fa-search me-2"></i>
                                                    –ó–Ω–∞—á–µ–Ω–Ω—è —Ñ—ñ–ª—å—Ç—Ä—É
                                                </label>
                                                <input type="text" 
                                                       class="form-control" 
                                                       x-model="form.filter_value"
                                                       placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: T-Shirt –∞–±–æ Nike">
                                                <div class="form-text">
                                                    <i class="fas fa-lightbulb me-1"></i>
                                                    –í–≤–µ–¥—ñ—Ç—å —Ç–æ—á–Ω—É –Ω–∞–∑–≤—É —Ç–∏–ø—É —Ç–æ–≤–∞—Ä—É –∞–±–æ –±—Ä–µ–Ω–¥—É
                                                </div>
                                            </div>

                                            <div class="mb-4">
                                                <label class="form-label">
                                                    <i class="fas fa-list-ol me-2"></i>
                                                    –û–±–º–µ–∂–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
                                                </label>
                                                <input type="number" 
                                                       class="form-control" 
                                                       x-model="form.limit_products"
                                                       min="1"
                                                       placeholder="–ó–∞–ª–∏—à—Ç–µ –ø–æ—Ä–æ–∂–Ω—ñ–º –¥–ª—è –≤—Å—ñ—Ö —Ç–æ–≤–∞—Ä—ñ–≤">
                                                <div class="form-text">
                                                    <i class="fas fa-shield-alt me-1"></i>
                                                    –†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è 5-10 —Ç–æ–≤–∞—Ä—ñ–≤ –¥–ª—è –ø–µ—Ä—à–æ–≥–æ —Ç–µ—Å—Ç—É
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="d-flex gap-3 justify-content-center">
                                        <button type="button" 
                                                class="btn btn-outline-primary" 
                                                @click="showPreview()"
                                                :disabled="!isFormValid() || isProcessing">
                                            <i class="fas fa-eye me-2"></i>
                                            –ü–æ–∫–∞–∑–∞—Ç–∏ –ø—Ä–∏–∫–ª–∞–¥
                                        </button>
                                        <button type="submit" 
                                                class="btn btn-primary"
                                                :disabled="!isFormValid() || isProcessing">
                                            <span x-show="isProcessing" class="spinner-border spinner-border-sm me-2"></span>
                                            <i class="fas fa-rocket me-2" x-show="!isProcessing"></i>
                                            –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –∑–º—ñ–Ω–∏
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <!-- Preview Section -->
                        <div x-show="preview" x-transition class="preview-section">
                            <div class="preview-title">
                                <i class="fas fa-eye me-2"></i>
                                –ü—Ä–∏–∫–ª–∞–¥ –∑–º—ñ–Ω–∏ –¥–ª—è —Ç–æ–≤–∞—Ä—É
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="price-before">
                                        <h6 class="text-muted mb-3">–î–û –ó–ú–Ü–ù</h6>
                                        <div x-text="`${preview?.product_title || '–¢–æ–≤–∞—Ä'}`" class="mb-2 fw-bold"></div>
                                        <div class="mb-2">
                                            <span class="price-old" x-show="preview?.current_compare_at_price" 
                                                  x-text="`$${preview?.current_compare_at_price?.toFixed(2) || ''}`"></span>
                                        </div>
                                        <div class="price-new" x-text="`$${preview?.current_price?.toFixed(2) || ''}`"></div>
                                        <div class="discount-badge" 
                                             x-text="`${preview?.current_discount_percentage?.toFixed(1) || 0}% –∑–Ω–∏–∂–∫–∞`"></div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="price-after">
                                        <h6 class="text-success mb-3">–ü–Ü–°–õ–Ø –ó–ú–Ü–ù</h6>
                                        <div x-text="`${preview?.product_title || '–¢–æ–≤–∞—Ä'}`" class="mb-2 fw-bold"></div>
                                        <div class="mb-2">
                                            <span class="price-old" x-show="preview?.new_compare_at_price" 
                                                  x-text="`$${preview?.new_compare_at_price?.toFixed(2) || ''}`"></span>
                                        </div>
                                        <div class="price-new" x-text="`$${preview?.new_price?.toFixed(2) || ''}`"></div>
                                        <div class="discount-badge" 
                                             x-text="`${preview?.new_discount_percentage?.toFixed(1) || 0}% –∑–Ω–∏–∂–∫–∞`"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row mt-3">
                                <div class="col-md-6">
                                    <div class="stat-box">
                                        <div class="stat-icon text-info">
                                            <i class="fas fa-chart-line"></i>
                                        </div>
                                        <div class="stat-number" 
                                             x-text="`${(preview?.discount_change || 0) > 0 ? '+' : ''}${(preview?.discount_change || 0).toFixed(1)}%`"></div>
                                        <div class="stat-label">–ó–º—ñ–Ω–∞ –∑–Ω–∏–∂–∫–∏</div>
                                    </div>
                                </div>
                                <div class="col-md-6" x-show="preview?.savings_amount && preview.savings_amount > 0">
                                    <div class="stat-box">
                                        <div class="stat-icon text-success">
                                            <i class="fas fa-piggy-bank"></i>
                                        </div>
                                        <div class="stat-number" x-text="`$${(preview?.savings_amount || 0).toFixed(2)}`"></div>
                                        <div class="stat-label">–ï–∫–æ–Ω–æ–º—ñ—è –ø–æ–∫—É–ø—Ü—è</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Progress Section -->
                        <div x-show="taskProgress" x-transition class="card">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-tasks me-2"></i>
                                    –ü—Ä–æ–≥—Ä–µ—Å –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–Ω–∏–∂–æ–∫
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="progress mb-4">
                                    <div class="progress-bar progress-bar-striped progress-bar-animated" 
                                         :style="`width: ${taskProgress?.percentage || 0}%`"
                                         x-text="`${taskProgress?.percentage || 0}%`">
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="stat-box">
                                            <div class="stat-icon text-primary">
                                                <i class="fas fa-tasks"></i>
                                            </div>
                                            <div class="stat-number" x-text="`${taskProgress?.current || 0}/${taskProgress?.total || 0}`"></div>
                                            <div class="stat-label">–û–±—Ä–æ–±–ª–µ–Ω–æ —Ç–æ–≤–∞—Ä—ñ–≤</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="stat-box">
                                            <div class="stat-icon text-success">
                                                <i class="fas fa-check-circle"></i>
                                            </div>
                                            <div class="stat-number" x-text="taskProgress?.successful || 0"></div>
                                            <div class="stat-label">–£—Å–ø—ñ—à–Ω–æ</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="stat-box">
                                            <div class="stat-icon text-warning">
                                                <i class="fas fa-exclamation-triangle"></i>
                                            </div>
                                            <div class="stat-number" x-text="taskProgress?.errors?.length || 0"></div>
                                            <div class="stat-label">–ü–æ–º–∏–ª–∫–∏</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="stat-box">
                                            <div class="stat-icon text-info">
                                                <i class="fas fa-percentage"></i>
                                            </div>
                                            <div class="stat-number" x-text="`${taskProgress?.percentage || 0}%`"></div>
                                            <div class="stat-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="current-item" x-show="taskProgress?.current_item">
                                    <i class="fas fa-spinner fa-spin me-2"></i>
                                    <span x-text="`–û–±—Ä–æ–±–ª—è—î—Ç—å—Å—è: ${taskProgress?.current_item}`"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Help Tab -->
                <div x-show="currentTab === 'help'">
                    <div class="py-4">
                        <h1 class="mb-4">
                            <i class="fas fa-graduation-cap me-3"></i>
                            –ü–æ–≤–Ω–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞–Ω–Ω—è
                        </h1>
                        
                        <div class="help-section">
                            <div class="help-title">
                                <i class="fas fa-info-circle"></i>
                                –©–æ —Ä–æ–±–∏—Ç—å —Å–∏—Å—Ç–µ–º–∞
                            </div>
                            <div class="help-content">
                                <p>–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–Ω–æ–≤–ª—é—î —Ü—ñ–Ω–∏ —Ç–∞ –∑–Ω–∏–∂–∫–∏ –¥–ª—è —Ç–æ–≤–∞—Ä—ñ–≤ —É –≤–∞—à–æ–º—É Shopify –º–∞–≥–∞–∑–∏–Ω—ñ. –£ Shopify —î –¥–≤–∞ —Ç–∏–ø–∏ —Ü—ñ–Ω:</p>
                                <ul>
                                    <li><strong>Price (—Ä–µ–∞–ª—å–Ω–∞ —Ü—ñ–Ω–∞)</strong> - —Ü–µ —Ç–∞ —Ü—ñ–Ω–∞, —è–∫—É –ø–ª–∞—Ç–∏—Ç—å –ø–æ–∫—É–ø–µ—Ü—å</li>
                                    <li><strong>Compare at price (–ø–æ—Ä—ñ–≤–Ω—è–ª—å–Ω–∞ —Ü—ñ–Ω–∞)</strong> - —Ü–µ –ø–µ—Ä–µ–∫—Ä–µ—Å–ª–µ–Ω–∞ —Ü—ñ–Ω–∞, —è–∫–∞ –ø–æ–∫–∞–∑—É—î "–≤—ñ–¥ —Å–∫—ñ–ª—å–∫–∏ –±—É–ª–æ"</li>
                                </ul>
                                <p>–ó–Ω–∏–∂–∫–∞ —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è —è–∫ —Ä—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ —Ü–∏–º–∏ —Ü—ñ–Ω–∞–º–∏: (Compare at price - Price) / Compare at price √ó 100%</p>
                            </div>
                        </div>

                        <div class="help-section">
                            <div class="help-title">
                                <i class="fas fa-chess"></i>
                                –î–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Å—Ç—Ä–∞—Ç–µ–≥—ñ–π
                            </div>
                            <div class="help-content">
                                <h6><i class="fas fa-arrow-up text-success me-2"></i>1. –ó–±—ñ–ª—å—à–∏—Ç–∏ –∑–Ω–∏–∂–∫—É</h6>
                                <ul>
                                    <li><strong>–©–æ —Ä–æ–±–∏—Ç—å:</strong> –ü—ñ–¥–≤–∏—â—É—î —Ç—ñ–ª—å–∫–∏ –ø–æ—Ä—ñ–≤–Ω—è–ª—å–Ω—É —Ü—ñ–Ω—É (–ø–µ—Ä–µ–∫—Ä–µ—Å–ª–µ–Ω—É)</li>
                                    <li><strong>–†–µ–∞–ª—å–Ω–∞ —Ü—ñ–Ω–∞:</strong> –ó–∞–ª–∏—à–∞—î—Ç—å—Å—è –±–µ–∑ –∑–º—ñ–Ω - –≤–∞—à –ø—Ä–∏–±—É—Ç–æ–∫ –Ω–µ –∑–º—ñ–Ω—é—î—Ç—å—Å—è</li>
                                    <li><strong>–ï—Ñ–µ–∫—Ç:</strong> –ó–Ω–∏–∂–∫–∞ –≤–∏–≥–ª—è–¥–∞—î –±—ñ–ª—å—à–æ—é, —Ç–æ–≤–∞—Ä —Å—Ç–∞—î –ø—Ä–∏–≤–∞–±–ª–∏–≤—ñ—à–∏–º</li>
                                    <li><strong>–ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:</strong> –ö–æ–ª–∏ —Ö–æ—á–µ—Ç–µ –∑–±—ñ–ª—å—à–∏—Ç–∏ –∫–æ–Ω–≤–µ—Ä—Å—ñ—é –±–µ–∑ –≤—Ç—Ä–∞—Ç–∏ –ø—Ä–∏–±—É—Ç–∫—É</li>
                                </ul>
                                <div class="example-box">
                                    <strong>–ü—Ä–∏–∫–ª–∞–¥:</strong> –ó–±—ñ–ª—å—à–µ–Ω–Ω—è –Ω–∞ 20%<br>
                                    –ë—É–ª–æ: $100 (—Ä–µ–∞–ª—å–Ω–∞), $120 (–ø–æ—Ä—ñ–≤–Ω—è–ª—å–Ω–∞) = 16.7% –∑–Ω–∏–∂–∫–∞<br>
                                    –°—Ç–∞–ª–æ: $100 (—Ä–µ–∞–ª—å–Ω–∞), $144 (–ø–æ—Ä—ñ–≤–Ω—è–ª—å–Ω–∞) = 30.6% –∑–Ω–∏–∂–∫–∞<br>
                                    <span class="text-success">‚úì –ó–Ω–∏–∂–∫–∞ –≤–∏—Ä–æ—Å–ª–∞ –∑ 16.7% –¥–æ 30.6%</span>
                                </div>

                                <h6><i class="fas fa-arrow-down text-info me-2"></i>2. –ó–º–µ–Ω—à–∏—Ç–∏ —Ü—ñ–Ω—É</h6>
                                <ul>
                                    <li><strong>–©–æ —Ä–æ–±–∏—Ç—å:</strong> –ó–Ω–∏–∂—É—î —Ä–µ–∞–ª—å–Ω—É —Ü—ñ–Ω—É —Ç–æ–≤–∞—Ä—É</li>
                                    <li><strong>–ü–æ—Ä—ñ–≤–Ω—è–ª—å–Ω–∞ —Ü—ñ–Ω–∞:</strong> –ó–∞–ª–∏—à–∞—î—Ç—å—Å—è –∞–±–æ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ</li>
                                    <li><strong>–ï—Ñ–µ–∫—Ç:</strong> –ü–æ–∫—É–ø–µ—Ü—å –ø–ª–∞—Ç–∏—Ç—å –º–µ–Ω—à–µ + –∑–Ω–∏–∂–∫–∞ —Å—Ç–∞—î –±—ñ–ª—å—à–æ—é</li>
                                    <li><strong>–ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:</strong> –î–ª—è —Ä–æ–∑–ø—Ä–æ–¥–∞–∂—ñ–≤, –∞–∫—Ü—ñ–π, –æ—á–∏—â–µ–Ω–Ω—è —Å–∫–ª–∞–¥—É</li>
                                </ul>
                                <div class="example-box">
                                    <strong>–ü—Ä–∏–∫–ª–∞–¥:</strong> –ó–Ω–∏–∂–µ–Ω–Ω—è –Ω–∞ 15%<br>
                                    –ë—É–ª–æ: $100 (—Ä–µ–∞–ª—å–Ω–∞), $120 (–ø–æ—Ä—ñ–≤–Ω—è–ª—å–Ω–∞) = 16.7% –∑–Ω–∏–∂–∫–∞<br>
                                    –°—Ç–∞–ª–æ: $85 (—Ä–µ–∞–ª—å–Ω–∞), $120 (–ø–æ—Ä—ñ–≤–Ω—è–ª—å–Ω–∞) = 29.2% –∑–Ω–∏–∂–∫–∞<br>
                                    <span class="text-success">‚úì –ü–æ–∫—É–ø–µ—Ü—å –µ–∫–æ–Ω–æ–º–∏—Ç—å $15 + –∑–Ω–∏–∂–∫–∞ –≤–∏—Ä–æ—Å–ª–∞ –¥–æ 29.2%</span>
                                </div>

                                <h6><i class="fas fa-exchange-alt text-warning me-2"></i>3. –ó–º—ñ–Ω–∏—Ç–∏ –æ–±–∏–¥–≤—ñ —Ü—ñ–Ω–∏</h6>
                                <ul>
                                    <li><strong>–©–æ —Ä–æ–±–∏—Ç—å:</strong> –û–¥–Ω–æ—á–∞—Å–Ω–æ –∑–º—ñ–Ω—é—î —Ä–µ–∞–ª—å–Ω—É —Ç–∞ –ø–æ—Ä—ñ–≤–Ω—è–ª—å–Ω—É —Ü—ñ–Ω—É</li>
                                    <li><strong>–ê–ª–≥–æ—Ä–∏—Ç–º:</strong> –ü–æ—Ä—ñ–≤–Ω—è–ª—å–Ω–∞ —Ü—ñ–Ω–∞ –∑–º—ñ–Ω—é—î—Ç—å—Å—è –≤ 1.5 —Ä–∞–∑–∏ –±—ñ–ª—å—à–µ</li>
                                    <li><strong>–ï—Ñ–µ–∫—Ç:</strong> –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –≥–Ω—É—á–∫—ñ—Å—Ç—å —É —Ü—ñ–Ω–æ—É—Ç–≤–æ—Ä–µ–Ω–Ω—ñ</li>
                                    <li><strong>–ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:</strong> –î–ª—è —Å–∫–ª–∞–¥–Ω–∏—Ö –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–∏—Ö —Å—Ç—Ä–∞—Ç–µ–≥—ñ–π</li>
                                </ul>
                                <div class="example-box">
                                    <strong>–ü—Ä–∏–∫–ª–∞–¥:</strong> –ó–±—ñ–ª—å—à–µ–Ω–Ω—è –Ω–∞ 10%<br>
                                    –ë—É–ª–æ: $100 (—Ä–µ–∞–ª—å–Ω–∞), $120 (–ø–æ—Ä—ñ–≤–Ω—è–ª—å–Ω–∞) = 16.7% –∑–Ω–∏–∂–∫–∞<br>
                                    –°—Ç–∞–ª–æ: $110 (—Ä–µ–∞–ª—å–Ω–∞), $138 (–ø–æ—Ä—ñ–≤–Ω—è–ª—å–Ω–∞) = 20.3% –∑–Ω–∏–∂–∫–∞<br>
                                    <span class="text-success">‚úì –¶—ñ–Ω–∞ –≤–∏—Ä–æ—Å–ª–∞, –∞–ª–µ –∑–Ω–∏–∂–∫–∞ —Ç–∞–∫–æ–∂ –∑–±—ñ–ª—å—à–∏–ª–∞—Å—å</span>
                                </div>

                                <h6><i class="fas fa-bullseye text-danger me-2"></i>4. –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Ç–æ—á–Ω—É –∑–Ω–∏–∂–∫—É</h6>
                                <ul>
                                    <li><strong>–©–æ —Ä–æ–±–∏—Ç—å:</strong> –†–æ–∑—Ä–∞—Ö–æ–≤—É—î –ø–æ—Ä—ñ–≤–Ω—è–ª—å–Ω—É —Ü—ñ–Ω—É –¥–ª—è –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è —Ü—ñ–ª—å–æ–≤–æ—ó –∑–Ω–∏–∂–∫–∏</li>
                                    <li><strong>–§–æ—Ä–º—É–ª–∞:</strong> –ü–æ—Ä—ñ–≤–Ω—è–ª—å–Ω–∞ —Ü—ñ–Ω–∞ = –†–µ–∞–ª—å–Ω–∞ —Ü—ñ–Ω–∞ √∑ (1 - –∑–Ω–∏–∂–∫–∞ √∑ 100)</li>
                                    <li><strong>–ï—Ñ–µ–∫—Ç:</strong> –¢–æ—á–Ω–∏–π –≤—ñ–¥—Å–æ—Ç–æ–∫ –∑–Ω–∏–∂–∫–∏ —è–∫ —É –º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É</li>
                                    <li><strong>–ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:</strong> –î–ª—è –∫–∞–º–ø–∞–Ω—ñ–π —Ç–∏–ø—É "30% –∑–Ω–∏–∂–∫–∞ –Ω–∞ –≤—Å–µ"</li>
                                </ul>
                                <div class="example-box">
                                    <strong>–ü—Ä–∏–∫–ª–∞–¥:</strong> –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–Ω–∏–∂–∫—É 30%<br>
                                    –ü–æ—Ç–æ—á–Ω–∞ —Ü—ñ–Ω–∞: $80<br>
                                    –°—Ç–∞–ª–æ: $80 (—Ä–µ–∞–ª—å–Ω–∞), $114.29 (–ø–æ—Ä—ñ–≤–Ω—è–ª—å–Ω–∞) = —Ç–æ—á–Ω–æ 30% –∑–Ω–∏–∂–∫–∞<br>
                                    <span class="text-success">‚úì –ì–∞—Ä–∞–Ω—Ç–æ–≤–∞–Ω–∞ —Ç–æ—á–Ω–∞ –∑–Ω–∏–∂–∫–∞ 30%</span>
                                </div>
                            </div>
                        </div>

                        <div class="help-section">
                            <div class="help-title">
                                <i class="fas fa-filter"></i>
                                –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è —Ç–æ–≤–∞—Ä—ñ–≤
                            </div>
                            <div class="help-content">
                                <h6>–¢–∏–ø–∏ —Ñ—ñ–ª—å—Ç—Ä—ñ–≤:</h6>
                                <ul>
                                    <li><strong>–í—Å—ñ —Ç–æ–≤–∞—Ä–∏:</strong> –ó–∞—Å—Ç–æ—Å–æ–≤—É—î –∑–º—ñ–Ω–∏ –¥–æ –≤—Å—å–æ–≥–æ –∞—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç—É –≤ –º–∞–≥–∞–∑–∏–Ω—ñ</li>
                                    <li><strong>–ó–∞ —Ç–∏–ø–æ–º —Ç–æ–≤–∞—Ä—É:</strong> –§—ñ–ª—å—Ç—Ä—É—î –ø–æ –ø–æ–ª—é "Product Type" (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: "T-Shirt", "Shoes", "Accessories")</li>
                                    <li><strong>–ó–∞ –≤–∏—Ä–æ–±–Ω–∏–∫–æ–º:</strong> –§—ñ–ª—å—Ç—Ä—É—î –ø–æ –ø–æ–ª—é "Vendor" (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: "Nike", "Adidas", "Apple")</li>
                                </ul>

                                <h6>–Ø–∫ –∑–Ω–∞–π—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è:</h6>
                                <div class="example-box">
                                    1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –≤ –∞–¥–º—ñ–Ω Shopify ‚Üí Products<br>
                                    2. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –±—É–¥—å-—è–∫–∏–π —Ç–æ–≤–∞—Ä<br>
                                    3. –ü–æ–¥–∏–≤—ñ—Ç—å—Å—è –ø–æ–ª—è "Product type" —Ç–∞ "Vendor"<br>
                                    4. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ç–æ—á–Ω—ñ –Ω–∞–∑–≤–∏ (–∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º —Ä–µ–≥—ñ—Å—Ç—Ä—É)
                                </div>

                                <h6>–û–±–º–µ–∂–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ:</h6>
                                <ul>
                                    <li><strong>–ü–æ—Ä–æ–∂–Ω—î –ø–æ–ª–µ:</strong> –û–±—Ä–æ–±–ª—è—î –≤—Å—ñ –∑–Ω–∞–π–¥–µ–Ω—ñ —Ç–æ–≤–∞—Ä–∏</li>
                                    <li><strong>–ß–∏—Å–ª–æ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ 10):</strong> –û–±—Ä–æ–±–ª—è—î —Ç—ñ–ª—å–∫–∏ –ø–µ—Ä—à—ñ 10 —Ç–æ–≤–∞—Ä—ñ–≤</li>
                                    <li><strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:</strong> –î–ª—è –ø–µ—Ä—à–æ–≥–æ —Ç–µ—Å—Ç—É –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å 5-10 —Ç–æ–≤–∞—Ä—ñ–≤</li>
                                </ul>
                            </div>
                        </div>

                        <div class="help-section">
                            <div class="help-title">
                                <i class="fas fa-shield-alt"></i>
                                –ë–µ–∑–ø–µ–∫–∞ —Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó
                            </div>
                            <div class="help-content">
                                <h6>–û–±–æ–≤'—è–∑–∫–æ–≤—ñ –∫—Ä–æ–∫–∏ –ø–µ—Ä–µ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º:</h6>
                                <ul>
                                    <li><strong>1. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è:</strong> –ó–∞–≤–∂–¥–∏ –Ω–∞—Ç–∏—Å–∫–∞–π—Ç–µ "–ü–æ–∫–∞–∑–∞—Ç–∏ –ø—Ä–∏–∫–ª–∞–¥" –ø–µ—Ä–µ–¥ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è–º</li>
                                    <li><strong>2. –ú–∞–ª—ñ –ø–∞—Ä—Ç—ñ—ó:</strong> –ü–æ—á–Ω—ñ—Ç—å –∑ 5-10 —Ç–æ–≤–∞—Ä—ñ–≤ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É</li>
                                    <li><strong>3. –†–µ–∑–µ—Ä–≤–Ω–∞ –∫–æ–ø—ñ—è:</strong> –ó–∞–ø–∏—à—ñ—Ç—å –ø–æ—Ç–æ—á–Ω—ñ —Ü—ñ–Ω–∏ –≤–∞–∂–ª–∏–≤–∏—Ö —Ç–æ–≤–∞—Ä—ñ–≤</li>
                                    <li><strong>4. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞:</strong> –ü—ñ—Å–ª—è –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫—ñ–ª—å–∫–∞ —Ç–æ–≤–∞—Ä—ñ–≤ –≤ –º–∞–≥–∞–∑–∏–Ω—ñ</li>
                                </ul>

                                <h6>–©–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞—Ç–∏:</h6>
                                <ul>
                                    <li><strong>–ú–∏—Ç—Ç—î–≤—ñ—Å—Ç—å:</strong> –ó–º—ñ–Ω–∏ –∑'—è–≤–ª—è—é—Ç—å—Å—è –≤ –º–∞–≥–∞–∑–∏–Ω—ñ –æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è –æ–±—Ä–æ–±–∫–∏</li>
                                    <li><strong>–í—Å—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏:</strong> –°–∏—Å—Ç–µ–º–∞ –æ–±—Ä–æ–±–ª—è—î –≤—Å—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ —Ç–æ–≤–∞—Ä—É (—Ä–æ–∑–º—ñ—Ä–∏, –∫–æ–ª—å–æ—Ä–∏)</li>
                                    <li><strong>–í–∞–ª—é—Ç–∏:</strong> –ü—Ä–∞—Ü—é—î –∑ –±—É–¥—å-—è–∫–æ—é –≤–∞–ª—é—Ç–æ—é –≤–∞—à–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω—É</li>
                                    <li><strong>–û–±–º–µ–∂–µ–Ω–Ω—è API:</strong> –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–µ–≥—É–ª—é—î —à–≤–∏–¥–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Ç—ñ–≤</li>
                                </ul>

                                <h6>–©–æ —Ä–æ–±–∏—Ç–∏, —è–∫—â–æ —â–æ—Å—å –ø—ñ—à–ª–æ –Ω–µ —Ç–∞–∫:</h6>
                                <ul>
                                    <li>–°–∏—Å—Ç–µ–º–∞ –∑–±–µ—Ä—ñ–≥–∞—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –≤—Å—ñ –∑–º—ñ–Ω–∏</li>
                                    <li>–£ Shopify Admin –º–æ–∂–Ω–∞ –≤—Ä—É—á–Ω—É –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ —Å—Ç–∞—Ä—ñ —Ü—ñ–Ω–∏</li>
                                    <li>–Ø–∫—â–æ –ø–æ–º–∏–ª–æ–∫ –±–∞–≥–∞—Ç–æ - –∑—É–ø–∏–Ω—ñ—Ç—å –ø—Ä–æ—Ü–µ—Å —ñ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</li>
                                    <li>–ó–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ —Å–ª—É–∂–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ Shopify —É –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö</li>
                                </ul>
                            </div>
                        </div>

                        <div class="help-section">
                            <div class="help-title">
                                <i class="fas fa-lightbulb"></i>
                                –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –ø–æ—Ä–∞–¥–∏ —Ç–∞ –∫–µ–π—Å–∏
                            </div>
                            <div class="help-content">
                                <h6>–ö–µ–π—Å 1: –ó–±—ñ–ª—å—à–µ–Ω–Ω—è –∫–æ–Ω–≤–µ—Ä—Å—ñ—ó –±–µ–∑ –≤—Ç—Ä–∞—Ç</h6>
                                <ul>
                                    <li><strong>–ú–µ—Ç–∞:</strong> –ó—Ä–æ–±–∏—Ç–∏ —Ç–æ–≤–∞—Ä–∏ –ø—Ä–∏–≤–∞–±–ª–∏–≤—ñ—à–∏–º–∏, –Ω–µ –≤—Ç—Ä–∞—á–∞—é—á–∏ –ø—Ä–∏–±—É—Ç–æ–∫</li>
                                    <li><strong>–°—Ç—Ä–∞—Ç–µ–≥—ñ—è:</strong> "–ó–±—ñ–ª—å—à–∏—Ç–∏ –∑–Ω–∏–∂–∫—É" –Ω–∞ 15-25%</li>
                                    <li><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong> –ó–Ω–∏–∂–∫–∞ –∑ 10% —Å—Ç–∞—î 25-30%, –ø–æ–∫—É–ø—Ü—ñ –±–∞—á–∞—Ç—å –∫—Ä–∞—â—É –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—é</li>
                                </ul>

                                <h6>–ö–µ–π—Å 2: –†–æ–∑–ø—Ä–æ–¥–∞–∂ —Å—Ç–∞—Ä–∏—Ö —Ç–æ–≤–∞—Ä—ñ–≤</h6>
                                <ul>
                                    <li><strong>–ú–µ—Ç–∞:</strong> –®–≤–∏–¥–∫–æ —Ä–æ–∑–ø—Ä–æ–¥–∞—Ç–∏ —Ç–æ–≤–∞—Ä–∏ –∑ —Å–∫–ª–∞–¥—É</li>
                                    <li><strong>–°—Ç—Ä–∞—Ç–µ–≥—ñ—è:</strong> "–ó–º–µ–Ω—à–∏—Ç–∏ —Ü—ñ–Ω—É" –Ω–∞ 20-40%</li>
                                    <li><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong> –†–µ–∞–ª—å–Ω—ñ –∑–Ω–∏–∂–∫–∏ –º–æ—Ç–∏–≤—É—é—Ç—å –¥–æ –ø–æ–∫—É–ø–∫–∏</li>
                                </ul>

                                <h6>–ö–µ–π—Å 3: –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–∞ –∞–∫—Ü—ñ—è "50% –∑–Ω–∏–∂–∫–∞"</h6>
                                <ul>
                                    <li><strong>–ú–µ—Ç–∞:</strong> –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Ä–µ–∫–ª–∞–º–Ω—É –∫–∞–º–ø–∞–Ω—ñ—é –∑ —Ç–æ—á–Ω–æ—é –∑–Ω–∏–∂–∫–æ—é</li>
                                    <li><strong>–°—Ç—Ä–∞—Ç–µ–≥—ñ—è:</strong> "–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Ç–æ—á–Ω—É –∑–Ω–∏–∂–∫—É" 50%</li>
                                    <li><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong> –í—Å—ñ —Ç–æ–≤–∞—Ä–∏ –º–∞—é—Ç—å —Ä—ñ–≤–Ω–æ 50% –∑–Ω–∏–∂–∫—É</li>
                                </ul>

                                <h6>–ü–æ—Ä–∞–¥–∏ –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ:</h6>
                                <ul>
                                    <li>–û–±—Ä–æ–±–ª—è–π—Ç–µ —Ç–æ–≤–∞—Ä–∏ —á–∞—Å—Ç–∏–Ω–∞–º–∏ –ø–æ 50-100 —à—Ç—É–∫</li>
                                    <li>–ù–µ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –∫—ñ–ª—å–∫–∞ –ø—Ä–æ—Ü–µ—Å—ñ–≤ –æ–¥–Ω–æ—á–∞—Å–Ω–æ</li>
                                    <li>–†–æ–±—ñ—Ç—å –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤ –≥–æ–¥–∏–Ω–∏ –Ω–∏–∑—å–∫–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –º–∞–≥–∞–∑–∏–Ω—É</li>
                                    <li>–°—Ç–µ–∂—Ç–µ –∑–∞ –ø—Ä–æ–≥—Ä–µ—Å–æ–º - —è–∫—â–æ –±–∞–≥–∞—Ç–æ –ø–æ–º–∏–ª–æ–∫, –∑—É–ø–∏–Ω—ñ—Ç—å—Å—è</li>
                                </ul>

                                <h6>–ê–Ω–∞–ª—ñ—Ç–∏–∫–∞ –ø—ñ—Å–ª—è –∑–º—ñ–Ω:</h6>
                                <ul>
                                    <li>–ü–æ—Ä—ñ–≤–Ω—è–π—Ç–µ –∫–æ–Ω–≤–µ—Ä—Å—ñ—é –¥–æ —Ç–∞ –ø—ñ—Å–ª—è –∑–º—ñ–Ω</li>
                                    <li>–í—ñ–¥—Å—Ç–µ–∂—É–π—Ç–µ —Å–µ—Ä–µ–¥–Ω—ñ–π —á–µ–∫ —Ç–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–¥–∞–∂—ñ–≤</li>
                                    <li>–ê–Ω–∞–ª—ñ–∑—É–π—Ç–µ –ø–æ–≤–µ–¥—ñ–Ω–∫—É –ø–æ–∫—É–ø—Ü—ñ–≤ –∑ –Ω–æ–≤–∏–º–∏ —Ü—ñ–Ω–∞–º–∏</li>
                                    <li>–ö–æ—Ä–∏–≥—É–π—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—é –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤</li>
                                </ul>
                            </div>
                        </div>

                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i>
                            <strong>–í–∞–∂–ª–∏–≤–æ:</strong> –¶—è —Å–∏—Å—Ç–µ–º–∞ —î –ø–æ—Ç—É–∂–Ω–∏–º —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º –¥–ª—è –∫–µ—Ä—É–≤–∞–Ω–Ω—è —Ü—ñ–Ω–∞–º–∏. 
                            –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —ó—ó –æ–±–µ—Ä–µ–∂–Ω–æ —Ç–∞ –∑–∞–≤–∂–¥–∏ —Ç–µ—Å—Ç—É–π—Ç–µ –Ω–∞ –º–∞–ª—ñ–π –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Ç–æ–≤–∞—Ä—ñ–≤ –ø–µ—Ä–µ–¥ –º–∞—Å–æ–≤–∏–º–∏ –∑–º—ñ–Ω–∞–º–∏.
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        function discountApp() {
            return {
                currentTab: 'main',
                form: {
                    strategy: '',
                    value: 10,
                    target_discount: 25,
                    filter_type: 'all',
                    filter_value: '',
                    limit_products: null
                },
                preview: null,
                taskProgress: null,
                isProcessing: false,

                selectStrategy(strategy) {
                    this.form.strategy = strategy;
                    this.preview = null;
                    console.log('–û–±—Ä–∞–Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—è:', strategy);
                },

                getHelpText() {
                    switch(this.form.strategy) {
                        case 'increase_compare_only':
                            return '–ù–∞ —Å–∫—ñ–ª—å–∫–∏ –≤—ñ–¥—Å–æ—Ç–∫—ñ–≤ –∑–±—ñ–ª—å—à–∏—Ç–∏ –ø–æ—Ä—ñ–≤–Ω—è–ª—å–Ω—É —Ü—ñ–Ω—É (—Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è 15-30%)';
                        case 'decrease_price_only':
                            return '–ù–∞ —Å–∫—ñ–ª—å–∫–∏ –≤—ñ–¥—Å–æ—Ç–∫—ñ–≤ –∑–º–µ–Ω—à–∏—Ç–∏ —Ä–µ–∞–ª—å–Ω—É —Ü—ñ–Ω—É (—Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è 10-25%)';
                        case 'both_directions':
                            return '–ë–∞–∑–æ–≤–∏–π –≤—ñ–¥—Å–æ—Ç–æ–∫ –¥–ª—è –∑–º—ñ–Ω–∏ –æ–±–æ—Ö —Ü—ñ–Ω (—Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–æ–∑—Ä–∞—Ö—É—î –ø—Ä–æ–ø–æ—Ä—Ü—ñ—ó)';
                        default:
                            return '';
                    }
                },

                isFormValid() {
                    if (!this.form.strategy) return false;
                    
                    if (this.form.filter_type !== 'all' && !this.form.filter_value.trim()) {
                        return false;
                    }
                    
                    if (this.form.strategy === 'set_discount_percentage') {
                        return this.form.target_discount > 0 && this.form.target_discount < 100;
                    } else {
                        return this.form.value > 0;
                    }
                },

                async showPreview() {
                    try {
                        const formData = new FormData();
                        formData.append('strategy', this.form.strategy);
                        
                        if (this.form.strategy === 'set_discount_percentage') {
                            formData.append('value', '0');
                            formData.append('target_discount', this.form.target_discount);
                        } else {
                            formData.append('value', this.form.value);
                        }
                        
                        formData.append('filter_type', this.form.filter_type);
                        formData.append('filter_value', this.form.filter_value);

                        const response = await fetch('/preview-changes', {
                            method: 'POST',
                            body: formData
                        });
                        
                        const data = await response.json();
                        
                        if (data.error) {
                            this.showAlert('–ü–æ–º–∏–ª–∫–∞: ' + data.error, 'danger');
                            this.preview = null;
                        } else {
                            this.preview = data;
                            this.showAlert('‚úÖ –ü—Ä–∏–∫–ª–∞–¥ —É—Å–ø—ñ—à–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ!', 'success');
                        }
                    } catch (error) {
                        this.showAlert('‚ùå –ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–∏–∫–ª–∞–¥—É: ' + error.message, 'danger');
                    }
                },

                async submitUpdate() {
                    this.isProcessing = true;
                    
                    try {
                        const formData = new FormData();
                        formData.append('strategy', this.form.strategy);
                        
                        if (this.form.strategy === 'set_discount_percentage') {
                            formData.append('value', '0');
                            formData.append('target_discount', this.form.target_discount);
                        } else {
                            formData.append('value', this.form.value);
                        }
                        
                        formData.append('filter_type', this.form.filter_type);
                        formData.append('filter_value', this.form.filter_value);
                        if (this.form.limit_products) {
                            formData.append('limit_products', this.form.limit_products);
                        }

                        const response = await fetch('/update-prices', {
                            method: 'POST',
                            body: formData
                        });

                        const data = await response.json();
                        
                        if (data.task_id) {
                            this.startProgressTracking(data.task_id);
                            this.showAlert('üöÄ –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–Ω–∏–∂–æ–∫ —Ä–æ–∑–ø–æ—á–∞—Ç–æ!', 'info');
                        }
                    } catch (error) {
                        this.showAlert('‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–ø—É—Å–∫—É: ' + error.message, 'danger');
                        this.isProcessing = false;
                    }
                },

                startProgressTracking(taskId) {
                    const checkProgress = async () => {
                        try {
                            const response = await fetch(`/progress/${taskId}`);
                            
                            if (!response.ok) {
                                throw new Error(`HTTP ${response.status}`);
                            }
                            
                            const data = await response.json();
                            this.taskProgress = data;
                            
                            if (data.status === 'completed') {
                                this.isProcessing = false;
                                const stats = data.final_stats || {};
                                this.showAlert(
                                    `üéâ –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ!\nüìä –û–±—Ä–æ–±–ª–µ–Ω–æ: ${stats.total_processed || 0}\n‚úÖ –£—Å–ø—ñ—à–Ω–æ: ${stats.successful_updates || 0}\n‚ùå –ü–æ–º–∏–ª–∫–∏: ${stats.errors_count || 0}`, 
                                    'success'
                                );
                                setTimeout(() => {
                                    this.taskProgress = null;
                                }, 10000);
                            } else if (data.status === 'failed') {
                                this.isProcessing = false;
                                this.showAlert('‚ùå –ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: ' + (data.error || '–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞'), 'danger');
                            } else {
                                setTimeout(checkProgress, 2000);
                            }
                        } catch (error) {
                            console.error('–ü–æ–º–∏–ª–∫–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø—Ä–æ–≥—Ä–µ—Å—É:', error);
                            setTimeout(checkProgress, 5000);
                        }
                    };
                    
                    checkProgress();
                },

                showAlert(message, type = 'info') {
                    const alert = document.createElement('div');
                    alert.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
                    alert.style.cssText = 'top: 20px; right: 20px; z-index: 9999; max-width: 450px; box-shadow: 0 8px 24px rgba(0,0,0,0.5);';
                    alert.innerHTML = `
                        <div style="white-space: pre-line;">${message}</div>
                        <button type="button" class="btn-close" data-bs-dismiss="alert" style="filter: brightness(0) invert(1);"></button>
                    `;
                    document.body.appendChild(alert);
                    
                    setTimeout(() => {
                        if (alert.parentNode) {
                            alert.remove();
                        }
                    }, 8000);
                }
            }
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
